var Tr=Object.defineProperty;var Mr=(i,t,e)=>t in i?Tr(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var Vt=(i,t,e)=>Mr(i,typeof t!="symbol"?t+"":t,e);import"../chunks/CWj6FrbW.js";import"../chunks/BwBI99aB.js";import{a as Ar,d as Ke,o as Ze,s as rt}from"../chunks/ycU_2_ja.js";import{h as Ae,x as Er,c as Ir,aP as Or,aQ as Lr,w as zr,G as Fr,F as Wr,I as Hr,U as Ur,a3 as Nr,E as Gr,aR as qr,aS as Br,e as $r,d as W,aT as Vr,aU as jr,aV as Qr,aW as Yr,aN as Xr,X as Wt,K as Je,s as bt,a1 as Kr,b as w,O as H,V as x,W as S,T as I,g as a,Q as wt,R as A,S as tr,P as jt,ad as er,L as z,M as Ee,N as Zr,aX as Jr,q as Ie,aM as ti,Y as Ct,aY as ei}from"../chunks/D5KdzY0j.js";import{i as B}from"../chunks/B0cj2f_u.js";import{g as T,h as ri,e as rr,i as ir,T as Oe,p as ii,A as si,c as Le,j as ni,W as at}from"../chunks/Duvcdp-S.js";import{w as sr,s as ot,c as ai}from"../chunks/ChyXsXdu.js";import{i as oi}from"../chunks/DaQO7wjj.js";import{p as we}from"../chunks/MYtgBzKL.js";import{b as nr}from"../chunks/CtMDA3SB.js";import{s as F,T as li}from"../chunks/BhN4PZSw.js";import{s as ci}from"../chunks/BD_ToE81.js";function _e(i,t,e){Ae&&Er();var r=i,s=Ur,n,l=Ir()?Or:Lr;zr(()=>{l(s,s=t())&&(n&&Fr(n),n=Wr(()=>e(r)))}),Ae&&(r=Hr)}const hi=()=>performance.now(),ft={tick:i=>requestAnimationFrame(i),now:()=>hi(),tasks:new Set};function ar(){const i=ft.now();ft.tasks.forEach(t=>{t.c(i)||(ft.tasks.delete(t),t.f())}),ft.tasks.size!==0&&ft.tick(ar)}function di(i){let t;return ft.tasks.size===0&&ft.tick(ar),{promise:new Promise(e=>{ft.tasks.add(t={c:i,f:e})}),abort(){ft.tasks.delete(t)}}}function Jt(i,t){sr(()=>{i.dispatchEvent(new CustomEvent(t))})}function ui(i){if(i==="float")return"cssFloat";if(i==="offset")return"cssOffset";if(i.startsWith("--"))return i;const t=i.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(e=>e[0].toUpperCase()+e.slice(1)).join("")}function ze(i){const t={},e=i.split(";");for(const r of e){const[s,n]=r.split(":");if(!s||n===void 0)break;const l=ui(s.trim());t[l]=n.trim()}return t}const _i=i=>i;function Fe(i,t,e,r){var s=(i&jr)!==0,n=(i&Qr)!==0,l=s&&n,o=(i&Vr)!==0,c=l?"both":s?"in":"out",d,u=t.inert,_=t.style.overflow,g,f;function h(){return sr(()=>d??(d=e()(t,(r==null?void 0:r())??{},{direction:c})))}var v={is_global:o,in(){var m;if(t.inert=u,!s){f==null||f.abort(),(m=f==null?void 0:f.reset)==null||m.call(f);return}n||g==null||g.abort(),Jt(t,"introstart"),g=ye(t,h(),f,1,()=>{Jt(t,"introend"),g==null||g.abort(),g=d=void 0,t.style.overflow=_})},out(m){if(!n){m==null||m(),d=void 0;return}t.inert=!0,Jt(t,"outrostart"),f=ye(t,h(),g,0,()=>{Jt(t,"outroend"),m==null||m()})},stop:()=>{g==null||g.abort(),f==null||f.abort()}},M=Nr;if((M.transitions??(M.transitions=[])).push(v),s&&Ar){var O=o;if(!O){for(var E=M.parent;E&&(E.f&Gr)!==0;)for(;(E=E.parent)&&(E.f&qr)===0;);O=!E||(E.f&Br)!==0}O&&$r(()=>{W(()=>v.in())})}}function ye(i,t,e,r,s){var n=r===1;if(Yr(t)){var l,o=!1;return Xr(()=>{if(!o){var M=t({direction:n?"in":"out"});l=ye(i,M,e,r,s)}}),{abort:()=>{o=!0,l==null||l.abort()},deactivate:()=>l.deactivate(),reset:()=>l.reset(),t:()=>l.t()}}if(e==null||e.deactivate(),!(t!=null&&t.duration))return s(),{abort:Wt,deactivate:Wt,reset:Wt,t:()=>r};const{delay:c=0,css:d,tick:u,easing:_=_i}=t;var g=[];if(n&&e===void 0&&(u&&u(0,1),d)){var f=ze(d(0,1));g.push(f,f)}var h=()=>1-r,v=i.animate(g,{duration:c,fill:"forwards"});return v.onfinish=()=>{v.cancel();var M=(e==null?void 0:e.t())??1-r;e==null||e.abort();var O=r-M,E=t.duration*Math.abs(O),m=[];if(E>0){var it=!1;if(d)for(var Pt=Math.ceil(E/16.666666666666668),j=0;j<=Pt;j+=1){var ct=M+O*_(j/Pt),Q=ze(d(ct,1-ct));m.push(Q),it||(it=Q.overflow==="hidden")}it&&(i.style.overflow="hidden"),h=()=>{var U=v.currentTime;return M+O*_(U/E)},u&&di(()=>{if(v.playState!=="running")return!1;var U=h();return u(U,1-U),!0})}v=i.animate(m,{duration:E,fill:"forwards"}),v.onfinish=()=>{h=()=>r,u==null||u(r,1-r),s()}},{abort:()=>{v&&(v.cancel(),v.effect=null,v.onfinish=Wt)},deactivate:()=>{s=Wt},reset:()=>{r===0&&(u==null||u(1,0))},t:()=>h()}}const fi=({url:i})=>({deckId:i.searchParams.get("id")||"",isExtraStudy:i.searchParams.get("isExtraStudy")==="true",cardIds:i.searchParams.get("cardIds")||encodeURIComponent("[]")}),sn=Object.freeze(Object.defineProperty({__proto__:null,load:fi},Symbol.toStringTag,{value:"Module"}));var fe,ge,ve;const Mt=typeof window>"u"?global:window,or=Mt.performance&&(()=>Mt.performance.now())||(()=>Date.now()),pe=((fe=Mt.requestAnimationFrame)===null||fe===void 0?void 0:fe.bind(Mt))||(i=>setTimeout(()=>i(or()),1e3/60)),We=((ge=Mt.cancelAnimationFrame)===null||ge===void 0?void 0:ge.bind(Mt))||clearTimeout;function re(i){return i[i.length-1]}const xe=(i,t)=>i<0?t+i:i,gi=(i,t)=>i[xe(t,i.length)];function lr(i,t){const e={...i};for(const r in t){const s=i[r],n=t[r];s!==n&&(s&&n&&typeof s=="object"&&typeof n=="object"&&!Array.isArray(n)?e[r]=lr(s,n):e[r]=n)}return e}function vi(i,t){const e=i.split("."),r={};let s=r;for(let n=0;n<e.length;n++){const l=n===e.length-1?t:{};s[e[n]]=l,s=l}return r}let He=0;function cr(){return He++,He}function te(i){return i.reduce((e,r)=>r+e,0)/i.length}function gt(i){const t=i.toUpperCase().trim();if(/^#([A-F0-9]{3}){1,2}$/.test(t)){let r=t.substring(1).split("");r.length===3&&(r=[r[0],r[0],r[1],r[1],r[2],r[2]]);const s=`${r.join("")}`;return{r:parseInt(s.slice(0,2),16),g:parseInt(s.slice(2,4),16),b:parseInt(s.slice(4,6),16),a:1}}const e=t.match(/^RGBA?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d*\.?\d+))?\)$/);if(e)return{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10),a:parseFloat(e[4]||1,10)};throw new Error(`Invalid color: ${i}`)}const pi=i=>i.replace(/^\s+/,"").replace(/\s+$/,"");function oe(i,t){const e={};for(let r=0;r<t;r++)e[r]=i;return e}function mi(i,t){const e={};for(let r=0;r<i;r++)e[r]=t(r);return e}const me=((ve=Mt.navigator)===null||ve===void 0?void 0:ve.userAgent)||"",ki=me.indexOf("MSIE ")>0||me.indexOf("Trident/")>0||me.indexOf("Edge/")>0,hr=()=>{};class Ci{constructor(t,e,r=hr){this._mutationChains=[],this._onStateChange=r,this.state={options:{drawingFadeDuration:e.drawingFadeDuration,drawingWidth:e.drawingWidth,drawingColor:gt(e.drawingColor),strokeColor:gt(e.strokeColor),outlineColor:gt(e.outlineColor),radicalColor:gt(e.radicalColor||e.strokeColor),highlightColor:gt(e.highlightColor)},character:{main:{opacity:e.showCharacter?1:0,strokes:{}},outline:{opacity:e.showOutline?1:0,strokes:{}},highlight:{opacity:1,strokes:{}}},userStrokes:null};for(let s=0;s<t.strokes.length;s++)this.state.character.main.strokes[s]={opacity:1,displayPortion:1},this.state.character.outline.strokes[s]={opacity:1,displayPortion:1},this.state.character.highlight.strokes[s]={opacity:0,displayPortion:1}}overwriteOnStateChange(t){this._onStateChange=t}updateState(t){const e=lr(this.state,t);this._onStateChange(e,this.state),this.state=e}run(t,e={}){const r=t.map(s=>s.scope);return this.cancelMutations(r),new Promise(s=>{const n={_isActive:!0,_index:0,_resolve:s,_mutations:t,_loop:e.loop,_scopes:r};this._mutationChains.push(n),this._run(n)})}_run(t){if(!t._isActive)return;const e=t._mutations;if(t._index>=e.length)if(t._loop)t._index=0;else{t._isActive=!1,this._mutationChains=this._mutationChains.filter(s=>s!==t),t._resolve({canceled:!1});return}t._mutations[t._index].run(this).then(()=>{t._isActive&&(t._index++,this._run(t))})}_getActiveMutations(){return this._mutationChains.map(t=>t._mutations[t._index])}pauseAll(){this._getActiveMutations().forEach(t=>t.pause())}resumeAll(){this._getActiveMutations().forEach(t=>t.resume())}cancelMutations(t){for(const e of this._mutationChains)for(const r of e._scopes)for(const s of t)(r.startsWith(s)||s.startsWith(r))&&this._cancelMutationChain(e)}cancelAll(){this.cancelMutations([""])}_cancelMutationChain(t){var e;t._isActive=!1;for(let r=t._index;r<t._mutations.length;r++)t._mutations[r].cancel(this);(e=t._resolve)===null||e===void 0||e.call(t,{canceled:!0}),this._mutationChains=this._mutationChains.filter(r=>r!==t)}}const At=(i,t)=>({x:i.x-t.x,y:i.y-t.y}),ie=i=>Math.sqrt(Math.pow(i.x,2)+Math.pow(i.y,2)),lt=(i,t)=>ie(At(i,t)),wi=(i,t)=>i.x===t.x&&i.y===t.y,Se=(i,t=1)=>{const e=t*10;return{x:Math.round(e*i.x)/e,y:Math.round(e*i.y)/e}},be=i=>{let t=i[0];return i.slice(1).reduce((r,s)=>{const n=lt(s,t);return t=s,r+n},0)},yi=(i,t)=>(i.x*t.x+i.y*t.y)/ie(i)/ie(t),Re=(i,t,e)=>{const r=At(t,i),s=e/ie(r);return{x:t.x+s*r.x,y:t.y+s*r.y}},Si=(i,t)=>{const e=i.length>=t.length?i:t,r=i.length>=t.length?t:i,s=(l,o,c,d)=>{if(l===0&&o===0)return lt(e[0],r[0]);if(l>0&&o===0)return Math.max(c[0],lt(e[l],r[0]));const u=d[d.length-1];return l===0&&o>0?Math.max(u,lt(e[0],r[o])):Math.max(Math.min(c[o],c[o-1],u),lt(e[l],r[o]))};let n=[];for(let l=0;l<e.length;l++){const o=[];for(let c=0;c<r.length;c++)o.push(s(l,c,n,o));n=o}return n[r.length-1]},Pi=(i,t=.05)=>{const e=i.slice(0,1);for(const r of i.slice(1)){const s=e[e.length-1],n=lt(r,s);if(n>t){const l=Math.ceil(n/t),o=n/l;for(let c=0;c<l;c++)e.push(Re(r,s,-1*o*(c+1)))}else e.push(r)}return e},Di=(i,t=30)=>{const r=be(i)/(t-1),s=[i[0]],n=re(i),l=i.slice(1);for(let o=0;o<t-2;o++){let c=re(s),d=r,u=!1;for(;!u;){const _=lt(c,l[0]);if(_<d)d-=_,c=l.shift();else{const g=Re(c,l[0],d-_);s.push(g),u=!0}}}return s.push(n),s},Ue=i=>{const t=Di(i),e=te(t.map(c=>c.x)),r=te(t.map(c=>c.y)),s={x:e,y:r},n=t.map(c=>At(c,s)),l=Math.sqrt(te([Math.pow(n[0].x,2)+Math.pow(n[0].y,2),Math.pow(re(n).x,2)+Math.pow(re(n).y,2)])),o=n.map(c=>({x:c.x/l,y:c.y/l}));return Pi(o)},xi=(i,t)=>i.map(e=>({x:Math.cos(t)*e.x-Math.sin(t)*e.y,y:Math.sin(t)*e.x+Math.cos(t)*e.y})),bi=i=>{if(i.length<3)return i;const t=[i[0],i[1]];return i.slice(2).forEach(e=>{const r=t.length,s=At(e,t[r-1]),n=At(t[r-1],t[r-2]);s.y*n.x-s.x*n.y===0&&t.pop(),t.push(e)}),t};function Te(i,t=!1){const e=Se(i[0]),r=i.slice(1);let s=`M ${e.x} ${e.y}`;return r.forEach(n=>{const l=Se(n);s+=` L ${l.x} ${l.y}`}),t&&(s+="Z"),s}const dr=(i,t)=>{const e=bi(i);if(e.length<2)return e;const r=e[1],s=e[0],n=Re(r,s,t),l=e.slice(1);return l.unshift(n),l};class Ri{constructor(t,e,r,s=!1){this.path=t,this.points=e,this.strokeNum=r,this.isInRadical=s}getStartingPoint(){return this.points[0]}getEndingPoint(){return this.points[this.points.length-1]}getLength(){return be(this.points)}getVectors(){let t=this.points[0];return this.points.slice(1).map(r=>{const s=At(r,t);return t=r,s})}getDistance(t){const e=this.points.map(r=>lt(r,t));return Math.min(...e)}getAverageDistance(t){return t.reduce((r,s)=>r+this.getDistance(s),0)/t.length}}class Ti{constructor(t,e){this.symbol=t,this.strokes=e}}function Mi({radStrokes:i,strokes:t,medians:e}){const r=s=>{var n;return((n=i==null?void 0:i.indexOf(s))!==null&&n!==void 0?n:-1)>=0};return t.map((s,n)=>{const l=e[n].map(o=>{const[c,d]=o;return{x:c,y:d}});return new Ri(s,l,n,r(n))})}function Ai(i,t){const e=Mi(t);return new Ti(i,e)}const Ei=[{x:0,y:-124},{x:1024,y:900}],[se,ur]=Ei,Ne=ur.x-se.x,Ge=ur.y-se.y;class qe{constructor(t){const{padding:e,width:r,height:s}=t;this.padding=e,this.width=r,this.height=s;const n=r-2*e,l=s-2*e,o=n/Ne,c=l/Ge;this.scale=Math.min(o,c);const d=e+(n-this.scale*Ne)/2,u=e+(l-this.scale*Ge)/2;this.xOffset=-1*se.x*this.scale+d,this.yOffset=-1*se.y*this.scale+u}convertExternalPoint(t){const e=(t.x-this.xOffset)/this.scale,r=(this.height-this.yOffset-t.y)/this.scale;return{x:e,y:r}}}const Ii=0,Be=250,Oi=.4,Li=.35;function zi(i,t,e,r={}){const s=t.strokes,n=Ni(i.points);if(n.length<2)return{isMatch:!1,meta:{isStrokeBackwards:!1}};const{isMatch:l,meta:o,avgDist:c}=ee(n,s[e],r);if(!l)return{isMatch:l,meta:o};const d=s.slice(e+1);let u=c;for(let _=0;_<d.length;_++){const{isMatch:g,avgDist:f}=ee(n,d[_],{...r,checkBackwards:!1});g&&f<u&&(u=f)}if(u<c){const _=.6*(u+c)/(2*c),{isMatch:g,meta:f}=ee(n,s[e],{...r,leniency:(r.leniency||1)*_});return{isMatch:g,meta:f}}return{isMatch:l,meta:o}}const Fi=(i,t,e)=>{const r=lt(t.getStartingPoint(),i[0]),s=lt(t.getEndingPoint(),i[i.length-1]);return r<=Be*e&&s<=Be*e},Wi=i=>{const t=[];let e=i[0];return i.slice(1).forEach(r=>{t.push(At(r,e)),e=r}),t},Hi=(i,t)=>{const e=Wi(i),r=t.getVectors(),s=e.map(l=>{const o=r.map(c=>yi(c,l));return Math.max(...o)});return te(s)>Ii},Ui=(i,t,e)=>e*(be(i)+25)/(t.getLength()+25)>=Li,Ni=i=>{if(i.length<2)return i;const[t,...e]=i,r=[t];for(const s of e)wi(s,r[r.length-1])||r.push(s);return r},Gi=[Math.PI/16,Math.PI/32,0,-1*Math.PI/32,-1*Math.PI/16],qi=(i,t,e)=>{const r=Ue(i),s=Ue(t);let n=1/0;return Gi.forEach(l=>{const o=Si(r,xi(s,l));o<n&&(n=o)}),n<=Oi*e},ee=(i,t,e)=>{const{leniency:r=1,isOutlineVisible:s=!1,checkBackwards:n=!0,averageDistanceThreshold:l=350}=e,o=t.getAverageDistance(i),c=s||t.strokeNum>0?.5:1,d=o<=l*c*r;if(!d)return{isMatch:!1,avgDist:o,meta:{isStrokeBackwards:!1}};const u=Fi(i,t,r),_=Hi(i,t),g=qi(i,t.points,r),f=Ui(i,t,r),h=d&&u&&_&&g&&f;return n&&!h&&ee([...i].reverse(),t,{...e,checkBackwards:!1}).isMatch?{isMatch:h,avgDist:o,meta:{isStrokeBackwards:!0}}:{isMatch:h,avgDist:o,meta:{isStrokeBackwards:!1}}};class Bi{constructor(t,e,r){this.id=t,this.points=[e],this.externalPoints=[r]}appendPoint(t,e){this.points.push(t),this.externalPoints.push(e)}}class $i{constructor(t){this._duration=t,this._startTime=null,this._paused=!1,this.scope=`delay.${t}`}run(){return this._startTime=or(),this._runningPromise=new Promise(t=>{this._resolve=t,this._timeout=setTimeout(()=>this.cancel(),this._duration)}),this._runningPromise}pause(){if(this._paused)return;const t=performance.now()-(this._startTime||0);this._duration=Math.max(0,this._duration-t),clearTimeout(this._timeout),this._paused=!0}resume(){this._paused&&(this._startTime=performance.now(),this._timeout=setTimeout(()=>this.cancel(),this._duration),this._paused=!1)}cancel(){clearTimeout(this._timeout),this._resolve&&this._resolve(),this._resolve=void 0}}class b{constructor(t,e,r={}){this._tick=s=>{if(this._startPauseTime!==null)return;const n=Math.min(1,(s-this._startTime-this._pausedDuration)/this._duration);if(n===1)this._renderState.updateState(this._values),this._frameHandle=void 0,this.cancel(this._renderState);else{const l=Vi(n),o=_r(this._startState,this._values,l);this._renderState.updateState(o),this._frameHandle=pe(this._tick)}},this.scope=t,this._valuesOrCallable=e,this._duration=r.duration||0,this._force=r.force,this._pausedDuration=0,this._startPauseTime=null}run(t){return this._values||this._inflateValues(t),this._duration===0&&t.updateState(this._values),this._duration===0||fr(t.state,this._values)?Promise.resolve():(this._renderState=t,this._startState=t.state,this._startTime=performance.now(),this._frameHandle=pe(this._tick),new Promise(e=>{this._resolve=e}))}_inflateValues(t){let e=this._valuesOrCallable;typeof this._valuesOrCallable=="function"&&(e=this._valuesOrCallable(t.state)),this._values=vi(this.scope,e)}pause(){this._startPauseTime===null&&(this._frameHandle&&We(this._frameHandle),this._startPauseTime=performance.now())}resume(){this._startPauseTime!==null&&(this._frameHandle=pe(this._tick),this._pausedDuration+=performance.now()-this._startPauseTime,this._startPauseTime=null)}cancel(t){var e;(e=this._resolve)===null||e===void 0||e.call(this),this._resolve=void 0,We(this._frameHandle||-1),this._frameHandle=void 0,this._force&&(this._values||this._inflateValues(t),t.updateState(this._values))}}b.Delay=$i;function _r(i,t,e){const r={};for(const s in t){const n=t[s],l=i==null?void 0:i[s];typeof l=="number"&&typeof n=="number"&&n>=0?r[s]=e*(n-l)+l:r[s]=_r(l,n,e)}return r}function fr(i,t){for(const e in t){const r=t[e],s=i==null?void 0:i[e];if(r>=0){if(r!==s)return!1}else if(!fr(s,r))return!1}return!0}const Vi=i=>-Math.cos(i*Math.PI)/2+.5,gr=(i,t,e)=>[new b(`character.${i}.strokes`,oe({opacity:1,displayPortion:1},t.strokes.length),{duration:e,force:!0})],Pe=(i,t,e)=>[new b(`character.${i}`,{opacity:1,strokes:oe({opacity:1,displayPortion:1},t.strokes.length)},{duration:e,force:!0})],Ht=(i,t,e)=>[new b(`character.${i}.opacity`,0,{duration:e,force:!0}),...gr(i,t,0)],$e=(i,t,e)=>[new b(`options.${i}`,t,{duration:e})],vr=(i,t,e)=>{const r=i.strokeNum,s=(i.getLength()+600)/(3*e);return[new b("options.highlightColor",t),new b("character.highlight",{opacity:1,strokes:{[r]:{displayPortion:0,opacity:0}}}),new b(`character.highlight.strokes.${r}`,{displayPortion:1,opacity:1},{duration:s}),new b(`character.highlight.strokes.${r}.opacity`,0,{duration:s,force:!0})]},pr=(i,t,e)=>{const r=t.strokeNum,s=(t.getLength()+600)/(3*e);return[new b(`character.${i}`,{opacity:1,strokes:{[r]:{displayPortion:0,opacity:1}}}),new b(`character.${i}.strokes.${r}.displayPortion`,1,{duration:s})]},ji=(i,t,e,r)=>{const s=l=>{const o=l.character[i],c={opacity:1,strokes:{}};for(let d=0;d<t.strokes.length;d++)c.strokes[d]={opacity:o.opacity*o.strokes[d].opacity};return c},n=t.strokes[e];return[new b(`character.${i}`,s),...pr(i,n,r)]},Qi=(i,t,e)=>[new b(`character.${i}.strokes.${t}`,{displayPortion:1,opacity:1},{duration:e,force:!0})],mr=(i,t,e,r,s)=>{let n=Ht(i,t,e);return n=n.concat(gr(i,t,0)),n.push(new b(`character.${i}`,{opacity:1,strokes:oe({opacity:0},t.strokes.length)},{force:!0})),t.strokes.forEach((l,o)=>{o>0&&n.push(new b.Delay(s)),n=n.concat(pr(i,l,r))}),n},Yi=(i,t,e,r,s,n)=>{const l=mr(i,t,e,r,s);return l.push(new b.Delay(n)),l},Xi=(i,t,e)=>[...Ht("main",i,t),new b("character.highlight",{opacity:1,strokes:oe({opacity:0},i.strokes.length)},{force:!0}),new b("character.main",{opacity:1,strokes:mi(i.strokes.length,r=>({opacity:r<e?1:0}))},{force:!0})],Ki=(i,t)=>[new b("quiz.activeUserStrokeId",i,{force:!0}),new b(`userStrokes.${i}`,{points:[t],opacity:1},{force:!0})],Zi=(i,t)=>[new b(`userStrokes.${i}.points`,t,{force:!0})],Ji=(i,t)=>[new b(`userStrokes.${i}.opacity`,0,{duration:t})],Ve=i=>(i==null?void 0:i.map(t=>new b(`userStrokes.${t}`,null,{force:!0})))||[],ts=(i,t,e)=>[new b("options.highlightColor",t),...Ht("highlight",i),...Pe("highlight",i,e/2),...Ht("highlight",i,e/2)],es=i=>({pathString:Te(i.externalPoints),points:i.points.map(t=>Se(t))});class rs{constructor(t,e,r){this._currentStrokeIndex=0,this._mistakesOnStroke=0,this._totalMistakes=0,this._character=t,this._renderState=e,this._isActive=!1,this._positioner=r}startQuiz(t){this._userStrokesIds&&this._renderState.run(Ve(this._userStrokesIds)),this._userStrokesIds=[],this._isActive=!0,this._options=t;const e=xe(t.quizStartStrokeNum,this._character.strokes.length);return this._currentStrokeIndex=Math.min(e,this._character.strokes.length-1),this._mistakesOnStroke=0,this._totalMistakes=0,this._renderState.run(Xi(this._character,t.strokeFadeDuration,this._currentStrokeIndex))}startUserStroke(t){var e;if(!this._isActive)return null;if(this._userStroke)return this.endUserStroke();const r=this._positioner.convertExternalPoint(t),s=cr();return this._userStroke=new Bi(s,r,t),(e=this._userStrokesIds)===null||e===void 0||e.push(s),this._renderState.run(Ki(s,r))}continueUserStroke(t){if(!this._userStroke)return Promise.resolve();const e=this._positioner.convertExternalPoint(t);this._userStroke.appendPoint(e,t);const r=this._userStroke.points.slice(0);return this._renderState.run(Zi(this._userStroke.id,r))}setPositioner(t){this._positioner=t}endUserStroke(){var t;if(!this._userStroke)return;if(this._renderState.run(Ji(this._userStroke.id,(t=this._options.drawingFadeDuration)!==null&&t!==void 0?t:300)),this._userStroke.points.length===1){this._userStroke=void 0;return}const{acceptBackwardsStrokes:e,markStrokeCorrectAfterMisses:r}=this._options,s=this._getCurrentStroke(),{isMatch:n,meta:l}=zi(this._userStroke,this._character,this._currentStrokeIndex,{isOutlineVisible:this._renderState.state.character.outline.opacity>0,leniency:this._options.leniency,averageDistanceThreshold:this._options.averageDistanceThreshold}),o=r&&this._mistakesOnStroke+1>=r;if(n||o||l.isStrokeBackwards&&e)this._handleSuccess(l);else{this._handleFailure(l);const{showHintAfterMisses:d,highlightColor:u,strokeHighlightSpeed:_}=this._options;d!==!1&&this._mistakesOnStroke>=d&&this._renderState.run(vr(s,gt(u),_))}this._userStroke=void 0}cancel(){this._isActive=!1,this._userStrokesIds&&this._renderState.run(Ve(this._userStrokesIds))}_getStrokeData({isCorrect:t,meta:e}){return{character:this._character.symbol,strokeNum:this._currentStrokeIndex,mistakesOnStroke:this._mistakesOnStroke,totalMistakes:this._totalMistakes,strokesRemaining:this._character.strokes.length-this._currentStrokeIndex-(t?1:0),drawnPath:es(this._userStroke),isBackwards:e.isStrokeBackwards}}nextStroke(){if(!this._options)return;const{strokes:t,symbol:e}=this._character,{onComplete:r,highlightOnComplete:s,strokeFadeDuration:n,highlightCompleteColor:l,highlightColor:o,strokeHighlightDuration:c}=this._options;let d=Qi("main",this._currentStrokeIndex,n);this._mistakesOnStroke=0,this._currentStrokeIndex+=1,this._currentStrokeIndex===t.length&&(this._isActive=!1,r==null||r({character:e,totalMistakes:this._totalMistakes}),s&&(d=d.concat(ts(this._character,gt(l||o),(c||0)*2)))),this._renderState.run(d)}_handleSuccess(t){if(!this._options)return;const{onCorrectStroke:e}=this._options;e==null||e({...this._getStrokeData({isCorrect:!0,meta:t})}),this.nextStroke()}_handleFailure(t){var e,r;this._mistakesOnStroke+=1,this._totalMistakes+=1,(e=(r=this._options).onMistake)===null||e===void 0||e.call(r,this._getStrokeData({isCorrect:!1,meta:t}))}_getCurrentStroke(){return this._character.strokes[this._currentStrokeIndex]}}function Rt(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function yt(i,t,e){i.setAttributeNS(null,t,e)}function ne(i,t){Object.keys(t).forEach(e=>yt(i,e,t[e]))}function is(i){let t="";return window.location&&window.location.href&&(t=window.location.href.replace(/#[^#]*$/,"").replace(/"/gi,"%22")),`url("${t}#${i}")`}function kr(i){var t;i==null||(t=i.parentNode)===null||t===void 0||t.removeChild(i)}class Tt{constructor(t){this.stroke=t,this._pathLength=t.getLength()+Tt.STROKE_WIDTH/2}_getStrokeDashoffset(t){return this._pathLength*.999*(1-t)}_getColor({strokeColor:t,radicalColor:e}){return e&&this.stroke.isInRadical?e:t}}Tt.STROKE_WIDTH=200;const je=200;class ss extends Tt{constructor(t){super(t),this._oldProps=void 0}mount(t){this._animationPath=Rt("path"),this._clip=Rt("clipPath"),this._strokePath=Rt("path");const e=`mask-${cr()}`;yt(this._clip,"id",e),yt(this._strokePath,"d",this.stroke.path),this._animationPath.style.opacity="0",yt(this._animationPath,"clip-path",is(e));const r=dr(this.stroke.points,je/2);return yt(this._animationPath,"d",Te(r)),ne(this._animationPath,{stroke:"#FFFFFF","stroke-width":je.toString(),fill:"none","stroke-linecap":"round","stroke-linejoin":"miter","stroke-dasharray":`${this._pathLength},${this._pathLength}`}),this._clip.appendChild(this._strokePath),t.defs.appendChild(this._clip),t.svg.appendChild(this._animationPath),this}render(t){var e,r;if(t===this._oldProps||!this._animationPath)return;t.displayPortion!==((e=this._oldProps)===null||e===void 0?void 0:e.displayPortion)&&(this._animationPath.style.strokeDashoffset=this._getStrokeDashoffset(t.displayPortion).toString());const s=this._getColor(t);if(!this._oldProps||s!==this._getColor(this._oldProps)){const{r:n,g:l,b:o,a:c}=s;ne(this._animationPath,{stroke:`rgba(${n},${l},${o},${c})`})}t.opacity!==((r=this._oldProps)===null||r===void 0?void 0:r.opacity)&&(this._animationPath.style.opacity=t.opacity.toString()),this._oldProps=t}}class ke{constructor(t){this._oldProps=void 0,this._strokeRenderers=t.strokes.map(e=>new ss(e))}mount(t){const e=t.createSubRenderTarget();this._group=e.svg,this._strokeRenderers.forEach(r=>{r.mount(e)})}render(t){var e,r;if(t===this._oldProps||!this._group)return;const{opacity:s,strokes:n,strokeColor:l,radicalColor:o=null}=t;if(s!==((e=this._oldProps)===null||e===void 0?void 0:e.opacity)&&(this._group.style.opacity=s.toString(),!ki)){var c;s===0?this._group.style.display="none":((c=this._oldProps)===null||c===void 0?void 0:c.opacity)===0&&this._group.style.removeProperty("display")}const d=!this._oldProps||l!==this._oldProps.strokeColor||o!==this._oldProps.radicalColor;if(d||n!==((r=this._oldProps)===null||r===void 0?void 0:r.strokes))for(let _=0;_<this._strokeRenderers.length;_++){var u;!d&&(u=this._oldProps)!==null&&u!==void 0&&u.strokes&&n[_]===this._oldProps.strokes[_]||this._strokeRenderers[_].render({strokeColor:l,radicalColor:o,opacity:n[_].opacity,displayPortion:n[_].displayPortion})}this._oldProps=t}}class ns{constructor(){this._oldProps=void 0}mount(t){this._path=Rt("path"),t.svg.appendChild(this._path)}render(t){var e,r,s,n;if(!(!this._path||t===this._oldProps)){if(t.strokeColor!==((e=this._oldProps)===null||e===void 0?void 0:e.strokeColor)||t.strokeWidth!==((r=this._oldProps)===null||r===void 0?void 0:r.strokeWidth)){const{r:l,g:o,b:c,a:d}=t.strokeColor;ne(this._path,{fill:"none",stroke:`rgba(${l},${o},${c},${d})`,"stroke-width":t.strokeWidth.toString(),"stroke-linecap":"round","stroke-linejoin":"round"})}t.opacity!==((s=this._oldProps)===null||s===void 0?void 0:s.opacity)&&yt(this._path,"opacity",t.opacity.toString()),t.points!==((n=this._oldProps)===null||n===void 0?void 0:n.points)&&yt(this._path,"d",Te(t.points)),this._oldProps=t}}destroy(){kr(this._path)}}class as{constructor(t,e){this._character=t,this._positioner=e,this._mainCharRenderer=new ke(t),this._outlineCharRenderer=new ke(t),this._highlightCharRenderer=new ke(t),this._userStrokeRenderers={}}mount(t){const e=t.createSubRenderTarget(),r=e.svg,{xOffset:s,yOffset:n,height:l,scale:o}=this._positioner;yt(r,"transform",`translate(${s}, ${l-n}) scale(${o}, ${-1*o})`),this._outlineCharRenderer.mount(e),this._mainCharRenderer.mount(e),this._highlightCharRenderer.mount(e),this._positionedTarget=e}render(t){const{main:e,outline:r,highlight:s}=t.character,{outlineColor:n,radicalColor:l,highlightColor:o,strokeColor:c,drawingWidth:d,drawingColor:u}=t.options;this._outlineCharRenderer.render({opacity:r.opacity,strokes:r.strokes,strokeColor:n}),this._mainCharRenderer.render({opacity:e.opacity,strokes:e.strokes,strokeColor:c,radicalColor:l}),this._highlightCharRenderer.render({opacity:s.opacity,strokes:s.strokes,strokeColor:o});const _=t.userStrokes||{};for(const f in this._userStrokeRenderers)if(!_[f]){var g;(g=this._userStrokeRenderers[f])===null||g===void 0||g.destroy(),delete this._userStrokeRenderers[f]}for(const f in _){const h=_[f];if(!h)continue;const v={strokeWidth:d,strokeColor:u,...h};(()=>{if(this._userStrokeRenderers[f])return this._userStrokeRenderers[f];const O=new ns;return O.mount(this._positionedTarget),this._userStrokeRenderers[f]=O,O})().render(v)}}destroy(){kr(this._positionedTarget.svg),this._positionedTarget.defs.innerHTML=""}}class Cr{constructor(t){this.node=t}addPointerStartListener(t){this.node.addEventListener("mousedown",e=>{t(this._eventify(e,this._getMousePoint))}),this.node.addEventListener("touchstart",e=>{t(this._eventify(e,this._getTouchPoint))})}addPointerMoveListener(t){this.node.addEventListener("mousemove",e=>{t(this._eventify(e,this._getMousePoint))}),this.node.addEventListener("touchmove",e=>{t(this._eventify(e,this._getTouchPoint))})}addPointerEndListener(t){document.addEventListener("mouseup",t),document.addEventListener("touchend",t)}getBoundingClientRect(){return this.node.getBoundingClientRect()}updateDimensions(t,e){this.node.setAttribute("width",`${t}`),this.node.setAttribute("height",`${e}`)}_eventify(t,e){return{getPoint:()=>e.call(this,t),preventDefault:()=>t.preventDefault()}}_getMousePoint(t){const{left:e,top:r}=this.getBoundingClientRect(),s=t.clientX-e,n=t.clientY-r;return{x:s,y:n}}_getTouchPoint(t){const{left:e,top:r}=this.getBoundingClientRect(),s=t.touches[0].clientX-e,n=t.touches[0].clientY-r;return{x:s,y:n}}}class ae extends Cr{constructor(t,e){super(t),this.svg=t,this.defs=e,"createSVGPoint"in t&&(this._pt=t.createSVGPoint())}static init(t,e="100%",r="100%"){const s=typeof t=="string"?document.getElementById(t):t;if(!s)throw new Error(`HanziWriter target element not found: ${t}`);const n=s.nodeName.toUpperCase(),l=(()=>{if(n==="SVG"||n==="G")return s;{const c=Rt("svg");return s.appendChild(c),c}})();ne(l,{width:e,height:r});const o=Rt("defs");return l.appendChild(o),new ae(l,o)}createSubRenderTarget(){const t=Rt("g");return this.svg.appendChild(t),new ae(t,this.defs)}_getMousePoint(t){if(this._pt&&(this._pt.x=t.clientX,this._pt.y=t.clientY,"getScreenCTM"in this.node)){var e;const r=this._pt.matrixTransform((e=this.node.getScreenCTM())===null||e===void 0?void 0:e.inverse());return{x:r.x,y:r.y}}return super._getMousePoint.call(this,t)}_getTouchPoint(t){if(this._pt&&(this._pt.x=t.touches[0].clientX,this._pt.y=t.touches[0].clientY,"getScreenCTM"in this.node)){var e;const r=this._pt.matrixTransform((e=this.node.getScreenCTM())===null||e===void 0?void 0:e.inverse());return{x:r.x,y:r.y}}return super._getTouchPoint(t)}}var os={HanziWriterRenderer:as,createRenderTarget:ae.init};const wr=(i,t)=>{i.beginPath();const e=t[0],r=t.slice(1);i.moveTo(e.x,e.y);for(const s of r)i.lineTo(s.x,s.y);i.stroke()},ls=i=>{const t=i.split(/(^|\s+)(?=[A-Z])/).filter(r=>r!==" "),e=[r=>r.beginPath()];for(const r of t){const[s,...n]=r.split(/\s+/),l=n.map(o=>parseFloat(o));s==="M"?e.push(o=>o.moveTo(...l)):s==="L"?e.push(o=>o.lineTo(...l)):s==="C"?e.push(o=>o.bezierCurveTo(...l)):s==="Q"&&e.push(o=>o.quadraticCurveTo(...l))}return r=>e.forEach(s=>s(r))};class cs extends Tt{constructor(t,e=!0){super(t),e&&Path2D?this._path2D=new Path2D(this.stroke.path):this._pathCmd=ls(this.stroke.path),this._extendedMaskPoints=dr(this.stroke.points,Tt.STROKE_WIDTH/2)}render(t,e){if(e.opacity<.05)return;if(t.save(),this._path2D)t.clip(this._path2D);else{var r;(r=this._pathCmd)===null||r===void 0||r.call(this,t),t.globalAlpha=0,t.stroke(),t.clip()}const{r:s,g:n,b:l,a:o}=this._getColor(e),c=o===1?`rgb(${s},${n},${l})`:`rgb(${s},${n},${l},${o})`,d=this._getStrokeDashoffset(e.displayPortion);t.globalAlpha=e.opacity,t.strokeStyle=c,t.fillStyle=c,t.lineWidth=Tt.STROKE_WIDTH,t.lineCap="round",t.lineJoin="round",t.setLineDash([this._pathLength,this._pathLength],d),t.lineDashOffset=d,wr(t,this._extendedMaskPoints),t.restore()}}class Ce{constructor(t){this._strokeRenderers=t.strokes.map(e=>new cs(e))}render(t,e){if(e.opacity<.05)return;const{opacity:r,strokeColor:s,radicalColor:n,strokes:l}=e;for(let o=0;o<this._strokeRenderers.length;o++)this._strokeRenderers[o].render(t,{strokeColor:s,radicalColor:n,opacity:l[o].opacity*r,displayPortion:l[o].displayPortion||0})}}function hs(i,t){if(t.opacity<.05)return;const{opacity:e,strokeWidth:r,strokeColor:s,points:n}=t,{r:l,g:o,b:c,a:d}=s;i.save(),i.globalAlpha=e,i.lineWidth=r,i.strokeStyle=`rgba(${l},${o},${c},${d})`,i.lineCap="round",i.lineJoin="round",wr(i,n),i.restore()}class ds{constructor(t,e){this.destroy=hr,this._character=t,this._positioner=e,this._mainCharRenderer=new Ce(t),this._outlineCharRenderer=new Ce(t),this._highlightCharRenderer=new Ce(t)}mount(t){this._target=t}_animationFrame(t){const{width:e,height:r,scale:s,xOffset:n,yOffset:l}=this._positioner,o=this._target.getContext();o.clearRect(0,0,e,r),o.save(),o.translate(n,r-l),o.transform(1,0,0,-1,0,0),o.scale(s,s),t(o),o.restore(),o.draw&&o.draw()}render(t){const{outline:e,main:r,highlight:s}=t.character,{outlineColor:n,strokeColor:l,radicalColor:o,highlightColor:c,drawingColor:d,drawingWidth:u}=t.options;this._animationFrame(_=>{this._outlineCharRenderer.render(_,{opacity:e.opacity,strokes:e.strokes,strokeColor:n}),this._mainCharRenderer.render(_,{opacity:r.opacity,strokes:r.strokes,strokeColor:l,radicalColor:o}),this._highlightCharRenderer.render(_,{opacity:s.opacity,strokes:s.strokes,strokeColor:c});const g=t.userStrokes||{};for(const f in g){const h=g[f];if(h){const v={strokeWidth:u,strokeColor:d,...h};hs(_,v)}}})}}class Me extends Cr{constructor(t){super(t)}static init(t,e="100%",r="100%"){const s=typeof t=="string"?document.getElementById(t):t;if(!s)throw new Error(`HanziWriter target element not found: ${t}`);const n=s.nodeName.toUpperCase(),l=(()=>{if(n==="CANVAS")return s;const o=document.createElement("canvas");return s.appendChild(o),o})();return l.setAttribute("width",e),l.setAttribute("height",r),new Me(l)}getContext(){return this.node.getContext("2d")}}var us={HanziWriterRenderer:ds,createRenderTarget:Me.init};const _s="2.0",fs=i=>`https://cdn.jsdelivr.net/npm/hanzi-writer-data@${_s}/${i}.json`,gs=(i,t,e)=>{const r=new XMLHttpRequest;r.overrideMimeType&&r.overrideMimeType("application/json"),r.open("GET",fs(i),!0),r.onerror=s=>{e(r,s)},r.onreadystatechange=()=>{r.readyState===4&&(r.status===200?t(JSON.parse(r.responseText)):r.status!==0&&e&&e(r))},r.send(null)},Qe={charDataLoader:gs,onLoadCharDataError:null,onLoadCharDataSuccess:null,showOutline:!0,showCharacter:!0,renderer:"svg",width:0,height:0,padding:20,strokeAnimationSpeed:1,strokeFadeDuration:400,strokeHighlightDuration:200,strokeHighlightSpeed:2,delayBetweenStrokes:1e3,delayBetweenLoops:2e3,strokeColor:"#555",radicalColor:null,highlightColor:"#AAF",outlineColor:"#DDD",drawingColor:"#333",leniency:1,showHintAfterMisses:3,highlightOnComplete:!0,highlightCompleteColor:null,markStrokeCorrectAfterMisses:!1,acceptBackwardsStrokes:!1,quizStartStrokeNum:0,averageDistanceThreshold:350,drawingFadeDuration:300,drawingWidth:4,strokeWidth:2,outlineWidth:2,rendererOverride:{}};class Ye{constructor(t){this._loadCounter=0,this._isLoading=!1,this.loadingFailed=!1,this._options=t}_debouncedLoad(t,e){const r=l=>{if(e===this._loadCounter){var o;(o=this._resolve)===null||o===void 0||o.call(this,l)}},s=l=>{if(e===this._loadCounter){var o;(o=this._reject)===null||o===void 0||o.call(this,l)}},n=this._options.charDataLoader(t,r,s);n&&("then"in n?n.then(r).catch(s):r(n))}_setupLoadingPromise(){return new Promise((t,e)=>{this._resolve=t,this._reject=e}).then(t=>{var e,r;return this._isLoading=!1,(e=(r=this._options).onLoadCharDataSuccess)===null||e===void 0||e.call(r,t),t}).catch(t=>{if(this._isLoading=!1,this.loadingFailed=!0,this._options.onLoadCharDataError){this._options.onLoadCharDataError(t);return}if(t instanceof Error)throw t;const e=new Error(`Failed to load char data for ${this._loadingChar}`);throw e.reason=t,e})}loadCharData(t){this._loadingChar=t;const e=this._setupLoadingPromise();return this.loadingFailed=!1,this._isLoading=!0,this._loadCounter++,this._debouncedLoad(t,this._loadCounter),e}}class St{constructor(t,e={}){const{HanziWriterRenderer:r,createRenderTarget:s}=e.renderer==="canvas"?us:os,n=e.rendererOverride||{};this._renderer={HanziWriterRenderer:n.HanziWriterRenderer||r,createRenderTarget:n.createRenderTarget||s},this.target=this._renderer.createRenderTarget(t,e.width,e.height),this._options=this._assignOptions(e),this._loadingManager=new Ye(this._options),this._setupListeners()}static create(t,e,r){const s=new St(t,r);return s.setCharacter(e),s}static loadCharacterData(t,e={}){const r=(()=>{const{_loadingManager:s,_loadingOptions:n}=St;return(s==null?void 0:s._loadingChar)===t&&n===e?s:new Ye({...Qe,...e})})();return St._loadingManager=r,St._loadingOptions=e,r.loadCharData(t)}static getScalingTransform(t,e,r=0){const s=new qe({width:t,height:e,padding:r});return{x:s.xOffset,y:s.yOffset,scale:s.scale,transform:pi(`
        translate(${s.xOffset}, ${s.height-s.yOffset})
        scale(${s.scale}, ${-1*s.scale})
      `).replace(/\s+/g," ")}}showCharacter(t={}){return this._options.showCharacter=!0,this._withData(()=>{var e;return(e=this._renderState)===null||e===void 0?void 0:e.run(Pe("main",this._character,typeof t.duration=="number"?t.duration:this._options.strokeFadeDuration)).then(r=>{var s;return(s=t.onComplete)===null||s===void 0||s.call(t,r),r})})}hideCharacter(t={}){return this._options.showCharacter=!1,this._withData(()=>{var e;return(e=this._renderState)===null||e===void 0?void 0:e.run(Ht("main",this._character,typeof t.duration=="number"?t.duration:this._options.strokeFadeDuration)).then(r=>{var s;return(s=t.onComplete)===null||s===void 0||s.call(t,r),r})})}animateCharacter(t={}){return this.cancelQuiz(),this._withData(()=>{var e;return(e=this._renderState)===null||e===void 0?void 0:e.run(mr("main",this._character,this._options.strokeFadeDuration,this._options.strokeAnimationSpeed,this._options.delayBetweenStrokes)).then(r=>{var s;return(s=t.onComplete)===null||s===void 0||s.call(t,r),r})})}animateStroke(t,e={}){return this.cancelQuiz(),this._withData(()=>{var r;return(r=this._renderState)===null||r===void 0?void 0:r.run(ji("main",this._character,xe(t,this._character.strokes.length),this._options.strokeAnimationSpeed)).then(s=>{var n;return(n=e.onComplete)===null||n===void 0||n.call(e,s),s})})}highlightStroke(t,e={}){const r=()=>{if(!(!this._character||!this._renderState))return this._renderState.run(vr(gi(this._character.strokes,t),gt(this._options.highlightColor),this._options.strokeHighlightSpeed)).then(s=>{var n;return(n=e.onComplete)===null||n===void 0||n.call(e,s),s})};return this._withData(r)}async loopCharacterAnimation(){return this.cancelQuiz(),this._withData(()=>this._renderState.run(Yi("main",this._character,this._options.strokeFadeDuration,this._options.strokeAnimationSpeed,this._options.delayBetweenStrokes,this._options.delayBetweenLoops),{loop:!0}))}pauseAnimation(){return this._withData(()=>{var t;return(t=this._renderState)===null||t===void 0?void 0:t.pauseAll()})}resumeAnimation(){return this._withData(()=>{var t;return(t=this._renderState)===null||t===void 0?void 0:t.resumeAll()})}showOutline(t={}){return this._options.showOutline=!0,this._withData(()=>{var e;return(e=this._renderState)===null||e===void 0?void 0:e.run(Pe("outline",this._character,typeof t.duration=="number"?t.duration:this._options.strokeFadeDuration)).then(r=>{var s;return(s=t.onComplete)===null||s===void 0||s.call(t,r),r})})}hideOutline(t={}){return this._options.showOutline=!1,this._withData(()=>{var e;return(e=this._renderState)===null||e===void 0?void 0:e.run(Ht("outline",this._character,typeof t.duration=="number"?t.duration:this._options.strokeFadeDuration)).then(r=>{var s;return(s=t.onComplete)===null||s===void 0||s.call(t,r),r})})}updateDimensions({width:t,height:e,padding:r}){if(t!==void 0&&(this._options.width=t),e!==void 0&&(this._options.height=e),r!==void 0&&(this._options.padding=r),this.target.updateDimensions(this._options.width,this._options.height),this._character&&this._renderState&&this._hanziWriterRenderer&&this._positioner){this._hanziWriterRenderer.destroy();const s=this._initAndMountHanziWriterRenderer(this._character);this._renderState.overwriteOnStateChange(n=>s.render(n)),s.render(this._renderState.state),this._quiz&&this._quiz.setPositioner(this._positioner)}}updateColor(t,e,r={}){var s;let n=[];const l=t==="radicalColor"&&!e?this._options.strokeColor:e,o=gt(l);this._options[t]=e;const c=(s=r.duration)!==null&&s!==void 0?s:this._options.strokeFadeDuration;return n=n.concat($e(t,o,c)),t==="radicalColor"&&!e&&(n=n.concat($e(t,null,0))),this._withData(()=>{var d;return(d=this._renderState)===null||d===void 0?void 0:d.run(n).then(u=>{var _;return(_=r.onComplete)===null||_===void 0||_.call(r,u),u})})}quiz(t={}){return this._withData(async()=>{this._character&&this._renderState&&this._positioner&&(this.cancelQuiz(),this._quiz=new rs(this._character,this._renderState,this._positioner),this._options={...this._options,...t},this._quiz.startQuiz(this._options))})}skipQuizStroke(){this._quiz&&this._quiz.nextStroke()}cancelQuiz(){this._quiz&&(this._quiz.cancel(),this._quiz=void 0)}setCharacter(t){return this.cancelQuiz(),this._char=t,this._hanziWriterRenderer&&this._hanziWriterRenderer.destroy(),this._renderState&&this._renderState.cancelAll(),this._hanziWriterRenderer=null,this._withDataPromise=this._loadingManager.loadCharData(t).then(e=>{if(!e||this._loadingManager.loadingFailed)return;this._character=Ai(t,e),this._renderState=new Ci(this._character,this._options,s=>r.render(s));const r=this._initAndMountHanziWriterRenderer(this._character);r.render(this._renderState.state)}),this._withDataPromise}_initAndMountHanziWriterRenderer(t){const{width:e,height:r,padding:s}=this._options;this._positioner=new qe({width:e,height:r,padding:s});const n=new this._renderer.HanziWriterRenderer(t,this._positioner);return n.mount(this.target),this._hanziWriterRenderer=n,n}async getCharacterData(){if(!this._char)throw new Error("setCharacter() must be called before calling getCharacterData()");return await this._withData(()=>this._character)}_assignOptions(t){const e={...Qe,...t};return t.strokeAnimationDuration&&!t.strokeAnimationSpeed&&(e.strokeAnimationSpeed=500/t.strokeAnimationDuration),t.strokeHighlightDuration&&!t.strokeHighlightSpeed&&(e.strokeHighlightSpeed=500/e.strokeHighlightDuration),t.highlightCompleteColor||(e.highlightCompleteColor=e.highlightColor),this._fillWidthAndHeight(e)}_fillWidthAndHeight(t){const e={...t};if(e.width&&!e.height)e.height=e.width;else if(e.height&&!e.width)e.width=e.height;else if(!e.width&&!e.height){const{width:r,height:s}=this.target.getBoundingClientRect(),n=Math.min(r,s);e.width=n,e.height=n}return e}_withData(t){if(this._loadingManager.loadingFailed)throw Error("Failed to load character data. Call setCharacter and try again.");return this._withDataPromise?this._withDataPromise.then(()=>{if(!this._loadingManager.loadingFailed)return t()}):Promise.resolve().then(t)}_setupListeners(){this.target.addPointerStartListener(t=>{this._quiz&&(t.preventDefault(),this._quiz.startUserStroke(t.getPoint()))}),this.target.addPointerMoveListener(t=>{this._quiz&&(t.preventDefault(),this._quiz.continueUserStroke(t.getPoint()))}),this.target.addPointerEndListener(()=>{var t;(t=this._quiz)===null||t===void 0||t.endUserStroke()})}}St._loadingManager=null;St._loadingOptions=null;class vs{constructor(t,e=!0){Vt(this,"audios");Vt(this,"currentIndex",0);Vt(this,"isPlaying",!1);Vt(this,"onEnded",this.handleEnded.bind(this));this.audios=t.map(r=>{const s=new Audio(r);return s.preload="auto",e&&s.load(),s})}handleEnded(){this.audios[this.currentIndex].removeEventListener("ended",this.onEnded),this.currentIndex++,this.currentIndex<this.audios.length?this.playCurrent():(this.isPlaying=!1,this.currentIndex=0)}playCurrent(){const t=this.audios[this.currentIndex];t.addEventListener("ended",this.onEnded),t.currentTime=0,t.play().catch(e=>{console.warn("Playback failed:",e),this.stop()})}play(){this.audios.length!==0&&(this.isPlaying&&this.stop(),this.isPlaying=!0,this.currentIndex=0,this.playCurrent())}stop(){if(!this.isPlaying)return;this.isPlaying=!1;const t=this.audios[this.currentIndex];t.pause(),t.currentTime=0,t.removeEventListener("ended",this.onEnded),this.currentIndex=0}}const ps={[T.Again]:"Fail",[T.Hard]:"Hard",[T.Good]:"Good",[T.Easy]:"Easy"},ms={[T.Again]:"again",[T.Hard]:"hard",[T.Good]:"good",[T.Easy]:"easy"},ks={[T.Again]:"fa fa-solid fa-face-frown",[T.Hard]:"fa fa-solid fa-face-meh",[T.Good]:"fa fa-solid fa-face-smile",[T.Easy]:"fa fa-solid fa-star"};var De;(i=>{function t(r){const s=r.correctStrokeCount===0?1/0:r.incorrectStrokeCount/r.correctStrokeCount;return s<.25||r.incorrectStrokeCount<=2?T.Good:s<.75||r.incorrectStrokeCount<=4?T.Hard:T.Again}i.getGrade=t;function e(r){switch(r){case T.Again:return"Again";case T.Hard:return"Hard";case T.Good:return"Good";default:return"Unknown"}}i.gradeToLabel=e})(De||(De={}));var Cs=(i,t)=>t(),ws=H('<button class="audio-button svelte-4rg8" aria-label="Play Audio"><i class="fa-solid fa-volume-low svelte-4rg8"></i></button>'),ys=H('<div class="new-element-indicator svelte-4rg8">New Card</div>'),Ss=H("<div>Warm Up</div>"),Ps=H('<div class="new-element-indicator is-hidden svelte-4rg8"></div>'),Ds=H('<span class="svelte-4rg8"> </span>'),xs=H('<span class="empty-character-box svelte-4rg8">&#x3000;</span>'),bs=H('<!> <div class="character-box-container svelte-4rg8"></div>',1),Rs=(i,t)=>t(),Ts=H('<button><i></i> <span class="svelte-4rg8"> </span></button>'),Ms=H('<div class="character-writer svelte-4rg8"><div class="meaning svelte-4rg8"> </div> <div><div class="reading svelte-4rg8"> </div> <!></div> <div class="character-container svelte-4rg8"><div class="grid-background svelte-4rg8"><svg xmlns="http://www.w3.org/2000/svg" id="grid-background-target" class="svelte-4rg8"><line x1="0" y1="0" class="svelte-4rg8"></line><line y1="0" x2="0" class="svelte-4rg8"></line><line y1="0" class="svelte-4rg8"></line><line x1="0" class="svelte-4rg8"></line></svg></div> <div class="bottom-container svelte-4rg8"><!></div> <!></div></div>');function As(i,t){var qt;Je(t,!0);let e=bt(500),r=bt(500),s="#DDD";const n=500,l=new Audio(`${nr}/assets/sounds/correct-choice-43861.mp3`);let o=bt(Kr([])),c=bt(!1),d=bt(!1),u=bt(!1);function _(){return parseFloat(getComputedStyle(document.documentElement).fontSize)}function g(){const k=_()*3*2;w(e,Math.min(document.documentElement.clientWidth-k,500),!0),w(r,a(e),!0)}let f=we(t,"isRequestManualGrade",15),h=we(t,"autoReviewData",15),v=bt(0),M=(qt=t.characterData)==null?void 0:qt.meanings.join("; ");function O(k){for(const C of k)if(C.startsWith(Oe))return ii(C.substring(Oe.length))}function E(){var k;w(d,!0),!a(u)&&(t.cardConfig.isFirstTime?(w(v,(a(v)+1)%t.characterData.characters.length),window.setTimeout(()=>{it(a(v))},n)):(l.play(),w(v,a(v)+1),a(v)==((k=t.characterData)==null?void 0:k.characters.length)?(t.onComplete({...h()}),w(c,!0),window.setTimeout(()=>{j()},n)):window.setTimeout(()=>{it(a(v))},n)))}let m;function it(k){if(a(u)||!t.characterData)return;m&&(t.cardConfig.isFirstTime||m.cancelQuiz(),m.hideCharacter(),m.hideOutline());const C=O(t.characterData.tags[k]??[]);m=St.create("grid-background-target",t.characterData.characters[k],{width:a(e),height:a(r),padding:5,showCharacter:!1,showOutline:t.cardConfig.isShowOutline,highlightOnComplete:!1,strokeColor:t.app.getChineseToneColor(C)??"#555",onComplete:()=>{E()}}),t.cardConfig.isFirstTime?(setTimeout(()=>{a(d)||j()},n),setTimeout(()=>{m.animateCharacter({onComplete:()=>{setTimeout(()=>{m.hideOutline(),m.hideCharacter(),E()},n)}})},n)):m.quiz({onMistake:()=>{h(h().incorrectStrokeCount++,!0),h(h().totalStrokeCount++,!0)},onCorrectStroke:()=>{h(h().correctStrokeCount++,!0),h(h().totalStrokeCount++,!0)}})}function Pt(){var C;const k=(C=t.characterData)==null?void 0:C.audioUrl;k&&w(o,k.map(Z=>{const pt=Z.map(mt=>ri(t.cardConfig.lang,mt));return new vs(pt)}),!0)}function j(){const k=Math.floor(Math.random()*a(o).length),C=a(o)[k];C.stop(),C.play()}function ct(){if(t.cardConfig.isWarmUp){window.alert("Can't change grade during warm-up, since grading doesn't affect scheduling in this phase.");return}f(!f())}function Q(k=0){const C=t.cardConfig.warmUpCount??0,Z=t.cardConfig.warmUpMaxCount;return`${Math.round((C+k)/Z*100)}%`}Ze(()=>(h({correctStrokeCount:0,incorrectStrokeCount:0,totalStrokeCount:0}),g(),Pt(),window.addEventListener("resize",g),it(0),()=>{w(u,!0),window.removeEventListener("resize",g)}));var U=Ms(),vt=x(U),Qt=x(vt,!0);S(vt);var P=I(vt,2);let ht;var Ut=x(P),dt=x(Ut,!0);S(Ut);var le=I(Ut,2);{var ce=k=>{var C=ws();C.__click=[Cs,j],A(k,C)};B(le,k=>{a(o).length>0&&k(ce)})}S(P);var Yt=I(P,2),Nt=x(Yt),Et=x(Nt),Dt=x(Et);F(Dt,"stroke",s);var It=I(Dt);F(It,"stroke",s);var xt=I(It);F(xt,"stroke",s);var Ot=I(xt);F(Ot,"stroke",s),S(Et),S(Nt);var Gt=I(Nt,2),he=x(Gt);{var de=k=>{var C=bs(),Z=jt(C);{var pt=y=>{var R=ys();A(y,R)},mt=(y,R)=>{{var Y=G=>{var J=Ss();let N,D;wt((L,K)=>{N=ot(J,1,"new-element-indicator svelte-4rg8",null,N,L),D=ci(J,"",D,K)},[()=>({"is-complete":a(c)}),()=>({"--progress":Q(),"--next-progress":Q(1)})]),A(G,J)},X=G=>{var J=Ps();A(G,J)};B(y,G=>{t.cardConfig.isWarmUp?G(Y):G(X,!1)},R)}};B(Z,y=>{t.cardConfig.isFirstTime?y(pt):y(mt,!1)})}var p=I(Z,2);rr(p,21,()=>t.characterData.characters,ir,(y,R,Y)=>{var X=er(),G=jt(X);{var J=D=>{var L=Ds(),K=x(L,!0);S(L),wt(()=>rt(K,a(R))),A(D,L)},N=D=>{var L=xs();A(D,L)};B(G,D=>{Y<a(v)||t.cardConfig.isFirstTime?D(J):D(N,!1)})}A(y,X)}),S(p),A(k,C)};B(he,k=>{var C;(C=t.characterData)!=null&&C.characters&&k(de)})}S(Gt);var Xt=I(Gt,2);{var Kt=k=>{var C=Ts();let Z;C.__click=[Rs,ct];var pt=x(C),mt=I(pt,2),p=x(mt,!0);S(mt),S(C),wt(y=>{Z=ot(C,1,`auto-review-indicator-container ${ms[t.autoGrade]}`,"svelte-4rg8",Z,y),ot(pt,1,ai(ks[t.autoGrade]),"svelte-4rg8"),rt(p,ps[t.autoGrade])},[()=>({blinking:f(),animated:f(),"echo-once":!f()})]),A(k,C)};B(Xt,k=>{t.autoGrade&&k(Kt)})}S(Yt),S(U),wt(k=>{var C;rt(Qt,M),ht=ot(P,1,"reading-container svelte-4rg8",null,ht,k),rt(dt,(C=t.characterData)==null?void 0:C.reading),F(Et,"width",a(e)),F(Et,"height",a(r)),F(Dt,"x2",a(e)),F(Dt,"y2",a(r)),F(It,"x1",a(e)),F(It,"y2",a(r)),F(xt,"x1",a(e)/2),F(xt,"x2",a(e)/2),F(xt,"y2",a(r)),F(Ot,"y1",a(r)/2),F(Ot,"x2",a(e)),F(Ot,"y2",a(r)/2)},[()=>({"is-hidden":!t.app.getConfig().zh.alwaysShowReading&&!a(c)&&!t.cardConfig.isFirstTime})]),A(i,U),tr()}Ke(["click"]);const Es=i=>i;function Is(i){const t=i-1;return t*t*t+1}function Xe(i){const t=typeof i=="string"&&i.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[i,"px"]}function Os(i,{delay:t=0,duration:e=400,easing:r=Es}={}){const s=+getComputedStyle(i).opacity;return{delay:t,duration:e,easing:r,css:n=>`opacity: ${n*s}`}}function Ls(i,{delay:t=0,duration:e=400,easing:r=Is,x:s=0,y:n=0,opacity:l=0}={}){const o=getComputedStyle(i),c=+o.opacity,d=o.transform==="none"?"":o.transform,u=c*(1-l),[_,g]=Xe(s),[f,h]=Xe(n);return{delay:t,duration:e,easing:r,css:(v,M)=>`
			transform: ${d} translate(${(1-v)*_}${g}, ${(1-v)*f}${h});
			opacity: ${c-u*M}`}}function zs(i){const t=i-1;return t*t*t+1}var Fs=H('<button><div class="review-button-inner svelte-1irkfzg"><div class="review-time svelte-1irkfzg"> </div> <div class="review-label svelte-1irkfzg"> </div></div></button>'),Ws=H('<div class="bottom-container svelte-1irkfzg"><div></div></div>'),Hs=H(`<div class="svelte-1irkfzg">You have done today's review.</div>`),Us=H('<div class="counter svelte-1irkfzg"><span class="underlined svelte-1irkfzg"><!></span></div>'),Ns=H('<div class="counter svelte-1irkfzg"><span> </span> <span> </span> <span> </span> <span> </span></div>'),Gs=H('<!> <div class="character-writer-container svelte-1irkfzg"><!></div> <!>',1),qs=H('<!> <div class="container svelte-1irkfzg"><!> <!></div>',1);function nn(i,t){Je(t,!1);const e=z(),r=z(),s=(p,y=Wt,R)=>{let Y=Ct(()=>ei(R==null?void 0:R(),""));var X=Ws(),G=x(X);rr(G,5,y,ir,(J,N)=>{var D=Fs();let L;D.__click=function(...V){var q;(q=a(N).onclick)==null||q.apply(this,V)};var K=x(D),$=x(K),st=x($,!0);S($);var tt=I($,2),et=x(tt,!0);S(tt),S(K),S(D),wt(V=>{L=ot(D,1,(a(N),W(()=>`review-button ${a(N).className||""}`)),"svelte-1irkfzg",L,V),rt(st,(a(N),W(()=>a(N).sublabel||""))),rt(et,(a(N),W(()=>a(N).label||"")))},[()=>({"is-complete":a(N).isComplete})],Ct),A(J,D)}),S(G),S(X),wt(()=>ot(G,1,`review-button-container ${a(Y)}`,"svelte-1irkfzg")),Fe(1,X,()=>Ls,()=>n),Fe(2,X,()=>Os,()=>l),A(p,X)},n={delay:100,y:-100,duration:300,easing:zs},l={duration:200};let o=we(t,"data",8),c=o().deckId||"",d=o().cardIds||encodeURIComponent("[]"),u=JSON.parse(decodeURIComponent(d)),_=o().isExtraStudy?"Extra Study":"Review",g=z(),f=z(!1),h=z(new si);Ze(async()=>{var p,y,R,Y;await a(h).init(),j=(y=(p=a(h).deckData[c])==null?void 0:p.tags)==null?void 0:y.includes(Le.ZH_YUE),await E.init(j?"yue":"zh"),w(h,a(h)),Pt=(Y=(R=a(h).deckData[c])==null?void 0:R.tags)==null?void 0:Y.includes(Le.ZH_TRAD),w(ct,a(h).isAutoGrading()),w(f,!0),o().isExtraStudy&&a(h).extraStudyHandler.registerReviewCardIdsOverride(u),dt()});let v=z(!1),M=z(!1),O=z(!1),E=new ni,m=z(void 0),it=z(!1),Pt=!1,j=!1,ct=z(!1),Q=z(void 0),U=z(!1),vt=z(0);const Qt=["Fail","Hard","Good","Easy"];let P=z(void 0),ht=z({1:"",2:"",3:"",4:""});function Ut(){w(v,!1),w(it,!1),w(Q,void 0),w(U,!1)}function dt(){Ut(),w(O,!0);const p=a(h).getNextCard(c);if(p===void 0){w(M,!0);return}a(h).getCard(c,p,!0)&&(w(O,!1),w(P,p),w(ht,a(h).getRatingScheduledTimeStr(c,p)),w(m,a(h).getWenbunCustomState(c,p)),Jr(vt))}function le(){a(h).startWarmUp(c,a(P)),w(it,!0),w(P,a(P)),w(ht,a(h).getRatingScheduledTimeStr(c,a(P))),w(m,a(h).getWenbunCustomState(c,a(P)))}function ce(p){const y=a(h).getCardWord(c,p),R=a(h).getConfig();return E.getCharacterWriterData(y,{convertToTraditional:Pt,mandarinReading:R.zh.mandarinReading,isCantonese:j,isPlayAudio:R.zh.playAudio})}function Yt(p){const y=a(h).getWarmUpCount(c,p),R=a(r)&&y===0;return{isFirstTime:a(e),isWarmUp:a(r)&&!Xt(p),warmUpCount:y,warmUpMaxCount:a(h).getMaxWarmUpCount(),isShowOutline:a(e)||R,lang:j?"yue":"zh"}}function Nt(p){w(v,!0),a(ct)&&w(Q,De.getGrade(p))}async function Et(p){a(h).rateCard(c,a(P),p),await a(h).save(),dt()}function Dt(p){switch(p){case T.Easy:return"review-button-easy";case T.Good:return"review-button-good";case T.Hard:return"review-button-hard";case T.Again:return"review-button-fail"}}async function It(){a(h).addIgnoredMark(c,a(P)),await a(h).save(),dt()}function xt(){a(h).extraStudyHandler.rateAgain(a(P)),dt()}function Ot(){a(h).extraStudyHandler.rateGood(a(P)),dt()}async function Gt(){a(h).storeAutoGradeLog(a(g).correctStrokeCount,a(g).incorrectStrokeCount,a(Q)),a(h).rateCard(c,a(P),a(Q)),await a(h).save(),dt()}function he(p){w(Q,p),w(U,!1)}async function de(){a(h).warmUpNext(c,a(P)),await a(h).save(),dt()}function Xt(p,y){const R=a(h).getWarmUpCount(c,p);return R===void 0?!0:R>=a(h).getMaxWarmUpCount()}Ee(()=>(a(m),at),()=>{w(e,a(m)===at.New)}),Ee(()=>(a(m),at),()=>{w(r,a(m)===at.WarmUp)}),Zr(),oi();var Kt=qs(),qt=jt(Kt);li(qt,{get title(){return _},get backUrl(){return`${nr??""}/`}});var k=I(qt,2),C=x(k);{var Z=p=>{var y=Hs();A(p,y)};B(C,p=>{a(M)&&p(Z)})}var pt=I(C,2);{var mt=p=>{var y=Gs(),R=jt(y);_e(R,()=>a(vt),D=>{var L=er(),K=jt(L);{var $=tt=>{var et=Us(),V=x(et),q=x(V);_e(q,()=>a(P),Bt=>{var ut=ti();wt(Lt=>rt(ut,Lt),[()=>(a(h),W(()=>a(h).extraStudyHandler.getCardsCount()||""))],Ct),A(Bt,ut)}),S(V),S(et),A(tt,et)},st=tt=>{var et=Ns(),V=x(et);let q;var Bt=x(V,!0);S(V);var ut=I(V,2);let Lt;var kt=x(ut,!0);S(ut);var zt=I(ut,2);let Zt;var ue=x(zt,!0);S(zt);var nt=I(zt,2);let Ft;var $t=x(nt,!0);S(nt),S(et),wt((_t,yr,Sr,Pr,Dr,xr,br,Rr)=>{q=ot(V,1,"deck-count-learn-relearn svelte-1irkfzg",null,q,_t),rt(Bt,yr),Lt=ot(ut,1,"deck-count-review svelte-1irkfzg",null,Lt,Sr),rt(kt,Pr),Zt=ot(zt,1,"deck-count-new svelte-1irkfzg",null,Zt,Dr),rt(ue,xr),Ft=ot(nt,1,"deck-count-previously-studied svelte-1irkfzg",null,Ft,br),rt($t,Rr)},[()=>({underlined:a(m)===at.Learning||a(m)===at.Relearning}),()=>(a(h),W(()=>a(h).getLearningRelearningCardsCount(c)||"")),()=>({underlined:a(m)===at.ReviewYoung||a(m)===at.ReviewMature}),()=>(a(h),W(()=>a(h).getScheduledReviewCardsCount(c)||"")),()=>({underlined:a(m)===at.New}),()=>(a(h),W(()=>a(h).getScheduledNewOrWarmUpCardsCount(c)||"")),()=>({underlined:a(m)===at.PreviouslyStudied}),()=>(a(h),W(()=>a(h).getScheduledPreviouslyStudiedCardsCount(c)||""))],Ct),A(tt,et)};B(K,tt=>{Ie(o()),W(()=>o().isExtraStudy)?tt($):tt(st,!1)})}A(D,L)});var Y=I(R,2),X=x(Y);_e(X,()=>[a(P),a(it),a(O)],D=>{const L=Ct(()=>(a(P),W(()=>ce(a(P))))),K=Ct(()=>(a(P),W(()=>Yt(a(P)))));As(D,{get app(){return a(h)},get characterData(){return a(L)},onComplete:$=>Nt($),get cardConfig(){return a(K)},get autoGrade(){return a(Q)},get isRequestManualGrade(){return a(U)},set isRequestManualGrade($){w(U,$)},get autoReviewData(){return a(g)},set autoReviewData($){w(g,$)},$$legacy:!0})}),S(Y);var G=I(Y,2);{var J=D=>{s(D,()=>[{label:"Ignore",sublabel:"(Don't Learn)",className:"review-button-fail",isComplete:!0,onclick:()=>It()},{label:""},{label:""},{label:"Learn",className:"review-button-easy",isComplete:!0,onclick:()=>le()}])},N=(D,L)=>{{var K=st=>{s(st,()=>[{label:""},{label:""},{label:""},{label:"Next",className:"review-button-easy",isComplete:a(v),onclick:()=>de()}])},$=(st,tt)=>{{var et=q=>{s(q,()=>[{label:"Again",sublabel:"(Put Back)",className:"review-button-fail",isComplete:a(v),onclick:()=>xt()},{label:""},{label:""},{label:"Good",className:"review-button-easy",isComplete:a(v),onclick:()=>Ot()}])},V=(q,Bt)=>{{var ut=kt=>{s(kt,()=>[{label:""},{label:""},{label:""},{label:"Next",className:"review-button-easy",isComplete:a(v),onclick:()=>Gt()}])},Lt=(kt,zt)=>{{var Zt=nt=>{var Ft=Ct(()=>(a(ht),a(v),W(()=>Qt.map(($t,_t)=>({label:$t,sublabel:a(ht)[_t+1],className:Dt(_t+1),isComplete:a(v),onclick:()=>he(_t+1)})))));s(nt,()=>a(Ft),()=>"pulsing")},ue=nt=>{var Ft=Ct(()=>(a(ht),a(v),W(()=>Qt.map(($t,_t)=>({label:$t,sublabel:a(ht)[_t+1],className:Dt(_t+1),isComplete:a(v),onclick:()=>Et(_t+1)})))));s(nt,()=>a(Ft))};B(kt,nt=>{a(ct)&&a(U)?nt(Zt):nt(ue,!1)},zt)}};B(q,kt=>{a(ct)&&!a(U)?kt(ut):kt(Lt,!1)},Bt)}};B(st,q=>{Ie(o()),W(()=>o().isExtraStudy)?q(et):q(V,!1)},tt)}};B(D,st=>{a(r),a(P),a(vt),W(()=>a(r)&&!Xt(a(P),a(vt)))?st(K):st($,!1)},L)}};B(G,D=>{a(e)?D(J):D(N,!1)})}A(p,y)};B(pt,p=>{a(f)&&a(P)!==void 0&&!a(M)&&p(mt)})}S(k),A(i,Kt),tr()}Ke(["click"]);export{nn as component,sn as universal};
